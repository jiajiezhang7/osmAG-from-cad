# Area Graph - åŒºåŸŸå›¾åˆ†å‰²

## æ¦‚è¿°

Area Graph é€šè¿‡ Voronoi å›¾å°†å®¤å†…ç¯å¢ƒåˆ†å‰²æˆä¸åŒåŒºåŸŸï¼ˆæˆ¿é—´ã€èµ°å»Šç­‰ï¼‰ï¼Œç”Ÿæˆæ‹“æ‰‘åœ°å›¾ç”¨äºæœºå™¨äººå¯¼èˆªå’Œè·¯å¾„è§„åˆ’ã€‚

**æ ¸å¿ƒè¾“å‡º**ï¼š**osmAG.osm** - åŒ…å«æˆ¿é—´å‡ ä½•å½¢çŠ¶ã€æ‹“æ‰‘å…³ç³»å’Œè¯­ä¹‰ä¿¡æ¯çš„æ ‡å‡†OSM XMLæ ¼å¼æ–‡ä»¶

## ç»Ÿä¸€å…¥å£è„šæœ¬

```bash
# ç¼–è¯‘åçš„å¯æ‰§è¡Œæ–‡ä»¶
./bin/example_segmentation <input_png> <resolution> <door_width> <corridor_width> <noise_percentage>
```

## å­¦æœ¯èƒŒæ™¯

åŸºäºè®ºæ–‡ï¼šHou, J., Yuan, Y., and Schwertfeger, S., "Area Graph: Generation of Topological Maps using the Voronoi Diagram", ICAR 2019.

ğŸ“„ [è®ºæ–‡é“¾æ¥](https://arxiv.org/abs/1910.01019)

## ç®—æ³•æµç¨‹

1. **é¢„å¤„ç†** â†’ **Voronoiå›¾ç”Ÿæˆ** â†’ **æ‹“æ‰‘å›¾ç”Ÿæˆ** â†’ **æˆ¿é—´æ£€æµ‹** â†’ **åŒºåŸŸåˆå¹¶** â†’ **osmAGå¯¼å‡º**

æ ¸å¿ƒæ­¥éª¤ï¼š
- ä½¿ç”¨ Alpha Shape ç®—æ³•è¿›è¡Œå®¶å…·ç§»é™¤å’Œæˆ¿é—´æ£€æµ‹
- åŸºäº Voronoi å›¾ç”Ÿæˆæ‹“æ‰‘ç»“æ„
- å¤šè¾¹å½¢ä¼˜åŒ–ï¼Œå»é™¤æ¯›åˆºå’Œå°–è§’
- è¾“å‡ºæ ‡å‡†OSM XMLæ ¼å¼

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒä¾èµ–

**Ubuntuç³»ç»Ÿå®‰è£…**ï¼š
```bash
sudo apt-get install g++ cmake qtbase5-dev libcgal-dev
```

### ç¼–è¯‘è¿è¡Œ

```bash
cd area_graph_segment/
mkdir build && cd build
cmake ..
make example_segmentation

# è¿è¡Œ
./bin/example_segmentation <input_png> <resolution> <door_width> <corridor_width> <noise_percentage>
```

## å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | æ¨èå€¼ |
|------|------|--------|
| `input_png` | è¾“å…¥PNGåœ°å›¾æ–‡ä»¶ï¼ˆç™½è‰²èƒŒæ™¯ï¼Œé»‘è‰²éšœç¢ç‰©ï¼‰ | - |
| `resolution` | åœ°å›¾åˆ†è¾¨ç‡ | `0.05` |
| `door_width` | æœ€å®½é—¨çš„å®½åº¦ï¼ˆ-1ä¸ºè‡ªåŠ¨ï¼‰ | `-1` æˆ– `0.85` |
| `corridor_width` | æœ€çª„èµ°å»Šå®½åº¦ï¼ˆ-1ä¸ºè‡ªåŠ¨ï¼‰ | `-1` æˆ– `2.7` |
| `noise_percentage` | å™ªå£°ç™¾åˆ†æ¯”ä¼°è®¡ | `1.5` |

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```bash
# è‡ªåŠ¨å‚æ•°ï¼ˆæ¨èï¼‰
./bin/example_segmentation input.png 0.05 -1 -1 1.5

# æ‰‹åŠ¨æŒ‡å®šé—¨å®½å’Œèµ°å»Šå®½åº¦
./bin/example_segmentation input.png 0.05 0.85 2.7 1.5
```

## é«˜çº§é…ç½®

é€šè¿‡ `config/params.yaml` å¯è°ƒæ•´ï¼š

**å¤šè¾¹å½¢å¤„ç†**ï¼š
- `simplify_tolerance`: ç®€åŒ–å®¹å·® (é»˜è®¤: 0.05)
- `spike_angle_threshold`: æ¯›åˆºè§’åº¦é˜ˆå€¼ (é»˜è®¤: 60.0Â°)

**å°æˆ¿é—´åˆå¹¶**ï¼š
- `min_area`: æœ€å°æˆ¿é—´é¢ç§¯ (é»˜è®¤: 4.0 mÂ²)
- `max_merge_distance`: æœ€å¤§åˆå¹¶è·ç¦» (é»˜è®¤: 1.5 m)

**åæ ‡ç³»ç»Ÿ**ï¼š
- `root_node`: åœ°ç†åæ ‡å‚è€ƒç‚¹è®¾ç½®

## è¾“å‡ºç»“æœ

| æ–‡ä»¶ | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| **osmAG.osm** | ğŸ¯ **æ ¸å¿ƒè¾“å‡º** - OSMæ ¼å¼çš„æ‹“æ‰‘åœ°å›¾ | æœºå™¨äººå¯¼èˆªã€è·¯å¾„è§„åˆ’ |
| å½©è‰²åŒºåŸŸå›¾ | ä¸åŒåŒºåŸŸçš„é¢œè‰²æ ‡è®°å›¾åƒ | å¯è§†åŒ–éªŒè¯ |
| è½®å»“å›¾ | åŒºåŸŸè¾¹ç•Œçš„é»‘ç™½å›¾åƒ | è°ƒè¯•åˆ†æ |

### osmAGæ ¼å¼ç‰¹ç‚¹

**osmAG**ï¼ˆOpenStreetMap Area Graphï¼‰æ˜¯æ ‡å‡†OSM XMLæ ¼å¼ï¼ŒåŒ…å«ï¼š
- ğŸ  **æˆ¿é—´å‡ ä½•**ï¼šå¤šè¾¹å½¢è½®å»“å’Œé¢ç§¯ä¿¡æ¯
- ğŸ”— **æ‹“æ‰‘å…³ç³»**ï¼šæˆ¿é—´é—´çš„è¿æ¥å…³ç³»
- ğŸ·ï¸ **è¯­ä¹‰æ ‡ç­¾**ï¼šæˆ¿é—´ç±»å‹ã€åç§°ç­‰å±æ€§
- ğŸ¯ **å¯¼èˆªå‹å¥½**ï¼šç›´æ¥æ”¯æŒOSMç”Ÿæ€ç³»ç»Ÿ

## ä»£ç æ¶æ„

| æ¨¡å— | åŠŸèƒ½ |
|------|------|
| **VoriGraph** | Voronoiå›¾æ•°æ®ç»“æ„å’Œå¤„ç† |
| **TopoGraph** | æ‹“æ‰‘å›¾ç”Ÿæˆå’Œä¼˜åŒ– |
| **RoomDect** | æˆ¿é—´æ£€æµ‹ç®—æ³• |
| **AreaGraph** | åŒºåŸŸå›¾ç”Ÿæˆå’Œåˆå¹¶ |
| **osmAGExport** | OSMæ ¼å¼å¯¼å‡ºå’Œå¤šè¾¹å½¢ä¼˜åŒ– |

## å‚æ•°è°ƒä¼˜å»ºè®®

**å‡å°‘è¿‡åº¦åˆ†å‰²**ï¼š
- å¢å¤§ `alphaShapeRemovalSquaredSize`: 625 â†’ 900-1000
- å¢å¤§ `topoGraphMarkAsFeatureEdgeLength`: 16 â†’ 20-24

**é…ç½®æ–‡ä»¶è°ƒæ•´**ï¼šä¿®æ”¹ `config/params.yaml` ä¸­çš„å¤šè¾¹å½¢å¤„ç†å’Œæˆ¿é—´åˆå¹¶å‚æ•°

## åº”ç”¨åœºæ™¯

- ğŸ¤– **æœºå™¨äººå¯¼èˆª**ï¼šé«˜çº§åˆ«æ‹“æ‰‘ä¿¡æ¯ï¼Œæ”¯æŒè¯­ä¹‰å¯¼èˆª
- ğŸ—ºï¸ **è·¯å¾„è§„åˆ’**ï¼šåŸºäºåŒºåŸŸçš„é«˜æ•ˆè·¯å¾„è§„åˆ’
- ğŸ“ **å®¤å†…å®šä½**ï¼šè¯­ä¹‰åŒ–å®šä½å’Œç©ºé—´ç†è§£
- ğŸ’¬ **äººæœºäº¤äº’**ï¼šç†è§£"å»ä¼šè®®å®¤"ç­‰è‡ªç„¶è¯­è¨€æŒ‡ä»¤

> ğŸ“ **ä¸‹ä¸€æ­¥**ï¼šä½¿ç”¨æ–‡æœ¬æå–æ¨¡å—ä¸ºæˆ¿é—´æ·»åŠ åç§°ï¼Œè¯¦è§ [cad2osm/script/text_extract_module/README.md](../cad2osm/script/text_extract_module/README.md)
